<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta name=author content="Ian Ovenell"><meta name=description content="Gets screen capture of device every 270 seconds and outputs screencap to timestamped png file in local directory
while true; do adb shell screencap -p | perl -pe 's/\x0D\x0A/\x0A/g' > ScreenCap.`date +%Y`.`date +%m`.`date+%d`-`date +%H`.`date +%M`.`date +%S`.png; sleep 270; done Gets logs from device and outputs them to a timestamped file in local directory
while true; do adb logcat -v time > logging`date +%Y`.`date +%m`.`date +%d`-`date +%H`.`date +%M`.`date +%S`txt; done Gets PID of adb shell ps | grep <packagename> Outputs battery level to console"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Useful ADB Oneliners"><meta name=twitter:description content="Gets screen capture of device every 270 seconds and outputs screencap to timestamped png file in local directory
while true; do adb shell screencap -p | perl -pe 's/\x0D\x0A/\x0A/g' > ScreenCap.`date +%Y`.`date +%m`.`date+%d`-`date +%H`.`date +%M`.`date +%S`.png; sleep 270; done Gets logs from device and outputs them to a timestamped file in local directory
while true; do adb logcat -v time > logging`date +%Y`.`date +%m`.`date +%d`-`date +%H`.`date +%M`.`date +%S`txt; done Gets PID of adb shell ps | grep <packagename> Outputs battery level to console"><meta property="og:title" content="Useful ADB Oneliners"><meta property="og:description" content="Gets screen capture of device every 270 seconds and outputs screencap to timestamped png file in local directory
while true; do adb shell screencap -p | perl -pe 's/\x0D\x0A/\x0A/g' > ScreenCap.`date +%Y`.`date +%m`.`date+%d`-`date +%H`.`date +%M`.`date +%S`.png; sleep 270; done Gets logs from device and outputs them to a timestamped file in local directory
while true; do adb logcat -v time > logging`date +%Y`.`date +%m`.`date +%d`-`date +%H`.`date +%M`.`date +%S`txt; done Gets PID of adb shell ps | grep <packagename> Outputs battery level to console"><meta property="og:type" content="article"><meta property="og:url" content="https://ovenell.ninja/posts/useful-adb-oneliners/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-06-14T00:00:00+00:00"><meta property="article:modified_time" content="2021-06-14T00:00:00+00:00"><title>Useful ADB Oneliners · Ian Ovenell</title><link rel=canonical href=https://ovenell.ninja/posts/useful-adb-oneliners/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.93c41bf1e522f85ecda7355985f09000f71fc1d64dda9f74051b0fa06210e93f.css integrity="sha256-k8Qb8eUi+F7NpzVZhfCQAPcfwdZN2p90BRsPoGIQ6T8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.f37febc669ce189201c1918fac1948a254686c8d366a312c2d72b2bb71ad97d1.css integrity="sha256-83/rxmnOGJIBwZGPrBlIolRobI02ajEsLXKyu3Gtl9E=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><script defer src=https://twemoji.maxcdn.com/v/13.0.2/twemoji.min.js integrity=sha384-wyB/MspSJ/r2bT2kCj44qtsYRYlpzO2oAPhRj5myrWD63dt6qWv4x8AZe7Fl3K3b crossorigin=anonymous></script><meta name=generator content="Hugo 0.83.1"></head><body class="preload-transitions colorscheme-dark" onload=twemoji.parse(document.body)><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Ian Ovenell</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://ovenell.ninja/posts/useful-adb-oneliners/>Useful ADB Oneliners</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2021-06-14T00:00:00Z>June 14, 2021</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
2-minute read</span></div><div class=categories><i class="fa fa-folder" aria-hidden=true></i>
<a href=/categories/blog/>blog</a></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/scripts/>scripts</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/adb/>adb</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/oneliners/>oneliners</a></span></div></div></header><div><p>Gets screen capture of device every 270 seconds and outputs screencap to timestamped png file in local directory</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>while true; do adb shell screencap -p | perl -pe &#39;s/\x0D\x0A/\x0A/g&#39; &gt; ScreenCap.`date +%Y`.`date +%m`.`date+%d`-`date +%H`.`date +%M`.`date +%S`.png; sleep 270; done
</code></pre></div><p>Gets logs from device and outputs them to a timestamped file in local directory</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>while true; do adb logcat -v time &gt; logging`date +%Y`.`date +%m`.`date +%d`-`date +%H`.`date +%M`.`date +%S`txt; done
</code></pre></div><p>Gets PID of</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>adb shell ps | grep &lt;packagename&gt;
</code></pre></div><p>Outputs battery level to console</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>adb shell dumpsys battery | grep level
</code></pre></div><p>Outputs battery usage for to console every two seconds</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>while true; do adb shell dumpsys cpuinfo | grep &lt;packagename&gt;;adb shell dumpsys battery | grep level; sleep 2;done
</code></pre></div><p>Gives permission to package to read logs</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>adb shell
su
pm grant &lt;packagename&gt; android.permission.READ_LOGS
</code></pre></div><p>find all apps NOT in /data and pull to current dir</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>adb shell &#34;pm list packages -f |  cut -d&#39;:&#39; -F2 | cut -d&#39;=&#39; -F1 | grep apk$&#34; | ForEach-Object { adb pull $_ }
</code></pre></div><p>find all apps NOT in /data && NOT in /vendor (likely no access) and pull to current dir</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>adb shell &#34;pm list packages -f |  cut -d&#39;:&#39; -F2 | cut -d&#39;=&#39; -F1 | grep apk$ | grep -v ^\/vendor&#34; | ForEach-Object { adb pull $_ }
</code></pre></div><p>find all apps in /data and pull to current dir
this will pull entire package folder not just apk. first this was out of convienience when parsing the strings, but turns out you get some intersting binaries along the way. see facebook for example</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>adb shell &#34;pm list packages -f |  cut -d&#39;:&#39; -F2 | grep ^\/data | cut -sd &#39;base.apk&#39; -F1 &#34; | ForEach-Object { adb pull $_ }
</code></pre></div></div><footer></footer></article></section></div><footer class=footer><section class=container><p>2021</p></section></footer></main><script src=/js/coder.min.235666b114443867d43eeb5799d51f6252965e5163f338285e113fa381d3d27e.js integrity="sha256-I1ZmsRREOGfUPutXmdUfYlKWXlFj8zgoXhE/o4HT0n4="></script><script>(function(e,b,f,c,a,d){b[c]=b[c]||function(){(b[c].q=b[c].q||[]).push(arguments)},a=e.createElement('script'),d=e.getElementsByTagName('script')[0],a.async=1,a.src=f,a.id='fathom-script',d.parentNode.insertBefore(a,d)})(document,window,'//analytics.example.com/tracker.js','fathom'),fathom('set','siteId','ABCDE'),fathom('trackPageview')</script><script async defer data-domain=example.com src=https://analytics.example.com/js/plausible.js></script><script data-goatcounter=https://ovenell-guru.goatcounter.com/count async src=//gc.zgo.at/count.js></script></body></html>