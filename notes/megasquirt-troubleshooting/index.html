<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta name=author content="Ian Ovenell"><meta name=description content="MegaSquirt® Connection Troubleshooting    MegaSquirt® Connection Troubleshooting
| &mdash;&ndash; | | Click on our menu buttons immediately below to find MegaSquirt® information quickly:
 MicroSquirt® Module V1/V2 MicroSquirt® Important
Safety
Information MicroSquirt®
Support
Forum   MShift™ TCU  MShift™ Intro GPIO Build Guide for 4L60E  Base circuits GPO1, GPO2, GPO3,
GPO4 (gear LEDs) VB1, VB2, VB3, VB4 PWM1, PWM2, PWM3, PWM4 GPI1, GPI2, GPI5
(2/4WD, Input2, downshift) GPI3 (Temperature) GPI4 (Brake sense) EGT1, EGT2, EGT3,"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="MegaSquirt® Connection Troubleshooting"><meta name=twitter:description content="MegaSquirt® Connection Troubleshooting    MegaSquirt® Connection Troubleshooting
| &mdash;&ndash; | | Click on our menu buttons immediately below to find MegaSquirt® information quickly:
 MicroSquirt® Module V1/V2 MicroSquirt® Important
Safety
Information MicroSquirt®
Support
Forum   MShift™ TCU  MShift™ Intro GPIO Build Guide for 4L60E  Base circuits GPO1, GPO2, GPO3,
GPO4 (gear LEDs) VB1, VB2, VB3, VB4 PWM1, PWM2, PWM3, PWM4 GPI1, GPI2, GPI5
(2/4WD, Input2, downshift) GPI3 (Temperature) GPI4 (Brake sense) EGT1, EGT2, EGT3,"><meta property="og:title" content="MegaSquirt® Connection Troubleshooting"><meta property="og:description" content="MegaSquirt® Connection Troubleshooting    MegaSquirt® Connection Troubleshooting
| &mdash;&ndash; | | Click on our menu buttons immediately below to find MegaSquirt® information quickly:
 MicroSquirt® Module V1/V2 MicroSquirt® Important
Safety
Information MicroSquirt®
Support
Forum   MShift™ TCU  MShift™ Intro GPIO Build Guide for 4L60E  Base circuits GPO1, GPO2, GPO3,
GPO4 (gear LEDs) VB1, VB2, VB3, VB4 PWM1, PWM2, PWM3, PWM4 GPI1, GPI2, GPI5
(2/4WD, Input2, downshift) GPI3 (Temperature) GPI4 (Brake sense) EGT1, EGT2, EGT3,"><meta property="og:type" content="article"><meta property="og:url" content="https://ovenell.ninja/notes/megasquirt-troubleshooting/"><meta property="article:section" content="notes"><meta property="article:published_time" content="2020-10-30T00:00:00+00:00"><meta property="article:modified_time" content="2020-10-30T00:00:00+00:00"><title>MegaSquirt® Connection Troubleshooting · Ian Ovenell</title><link rel=canonical href=https://ovenell.ninja/notes/megasquirt-troubleshooting/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.93c41bf1e522f85ecda7355985f09000f71fc1d64dda9f74051b0fa06210e93f.css integrity="sha256-k8Qb8eUi+F7NpzVZhfCQAPcfwdZN2p90BRsPoGIQ6T8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.f37febc669ce189201c1918fac1948a254686c8d366a312c2d72b2bb71ad97d1.css integrity="sha256-83/rxmnOGJIBwZGPrBlIolRobI02ajEsLXKyu3Gtl9E=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><script defer src=https://twemoji.maxcdn.com/v/13.0.2/twemoji.min.js integrity=sha384-wyB/MspSJ/r2bT2kCj44qtsYRYlpzO2oAPhRj5myrWD63dt6qWv4x8AZe7Fl3K3b crossorigin=anonymous></script><meta name=generator content="Hugo 0.83.1"></head><body class="preload-transitions colorscheme-dark" onload=twemoji.parse(document.body)><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Ian Ovenell</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li></ul></section></nav><div class=content><section class="container page"><article><header><h1 class=title><a class=title-link href=https://ovenell.ninja/notes/megasquirt-troubleshooting/>MegaSquirt® Connection Troubleshooting</a></h1></header><h1 id=megasquirt-connection-troubleshooting>MegaSquirt® Connection Troubleshooting
<a class=heading-link href=#megasquirt-connection-troubleshooting><i class="fa fa-link" aria-hidden=true></i></a></h1><p>MegaSquirt® Connection Troubleshooting</p><p>| &mdash;&ndash; |
| <em>Click on our menu buttons immediately below to find MegaSquirt® information quickly:</em></p><ul><li><a href=http://www.microsquirtmodule.com/index.htm title="The SMT basis for building your interface board to specific vehicles">MicroSquirt® Module</a></li><li><a href=http://www.microsquirt.info/v2index.htm title="Manual for the V1 and V2 MicroSquirt® controllers">V1/V2 MicroSquirt®</a></li><li><a href=http://www.useasydocs.com/safety.htm title="For your protection, be sure to read thes safety instructions"><strong>Important<br>Safety<br>Information</strong></a></li><li><a href=http://www.microsquirt.com/index.php title>MicroSquirt®<br>Support<br>Forum</a></li><li><ul><li><a href=http://www.megamanual.com# title="GPIO based universal transmission control software from B&G">MShift™ TCU</a><ul><li><a href=http://www.msgpio.com/manuals/mshift/index.html title="GPIO based universal transmission control software from B&G">MShift™ Intro</a></li><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html title="MShift/GPIO Assembly Guide">GPIO Build Guide for 4L60E</a><ul><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html#base>Base circuits</a></li><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html#led>GPO1, GPO2, GPO3,<br>GPO4 (gear LEDs)</a></li><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html#vb>VB1, VB2, VB3, VB4</a></li><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html#pwm>PWM1, PWM2, PWM3, PWM4</a></li><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html#gpi>GPI1, GPI2, GPI5<br>(2/4WD, Input2, downshift)</a></li><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html#gpi3>GPI3 (Temperature)</a></li><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html#gpi4>GPI4 (Brake sense)</a></li><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html#egt>EGT1, EGT2, EGT3,<br>EGT4 (non-CAN Load,<br>line pressure, Input3,<br>Input1)</a></li><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html#vr1>VR1 (Vehicle<br>Speed Sensor)</a></li><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html#vr2>VR2 (Upshift button)</a></li><li><a href=http://www.msgpio.com/manuals/mshift/assembly.html#finish>Finishing Touches</a></li><li><a href=http://www.msgpio.com/manuals/mshift/test.html title>Testing your<br>GPIO Board</a></li></ul></li><li><a href=http://www.msgpio.com/manuals/mshift/wiring.html title="MShift/GPIO 4L60e External Wiring Guide">External Wiring Guide for 4L60E</a></li><li><a href=http://www.msgpio.com/manuals/mshift/V5code.html>Current Release Code</a></li><li><a href=http://www.msgpio.com/manuals/mshift/V5tune.html>User Settings</a></li><li><a href=http://www.msgpio.com/manuals/mshift/V6code.html>βeta Code</a></li><li><a href=http://www.megamanual.com#>Code Archives</a></li><li><a href=http://www.diyautotune.com/catalog/gpio-board-c-77.html>Purchase a<br>GPIO kit</a></li><li><a href=http://www.msgpio.com/manuals/mshift/tuning.html>Working with the Shift Table</a></li><li><a href=http://www.msgpio.com/manuals/mshift/gpconnect.htm>Serial<br>Connection<br>Troubleshooting</a></li><li><a href=http://www.msgpio.com/manuals/mshift/cpt.html>CANbus<br>Set-Up</a></li><li><a href=http://www.msgpio.com/manuals/mshift/vss.html>Solving VSS<br>Issues</a></li><li><a href=http://www.msgpio.com/manuals/mshift/portspins.html>Ports, pins, circuits, connections</a></li><li><a href=http://www.msgpio.com/forums/index.php>MShift™ Discussion<br>Forums</a></li><li><a href=http://www.megamanual.com# title="Various topics regarding GPIO circuits and MShift subjects">Misc. MShift™<br>Topics</a></li><li><a href=http://www.msgpio.com/manuals/mshift/sitemap.html>MShift™ sitemap</a></li></ul></li></ul></li><li><a href=http://www.msgpio.com/manuals/iocode/code.htm title="Initial code to use in your own project">Template Project Code</a></li><li><a href=http://www.msgpio.com/manuals/index.htm title="The General Purpose I/O Board Introduction">GPIO Board Intro</a></li><li><a href=http://www.msgpio.com/forums/index.php title="Support forum for GPIO and MShift applications">MShift™/GPIO<br>Support Forum</a>
|</li></ul><p><img src=http://www.megamanual.com/logo.gif alt></p><h2 id=megasquirt-connection-troubleshooting-guide>MegaSquirt® Connection Troubleshooting Guide
<a class=heading-link href=#megasquirt-connection-troubleshooting-guide><i class="fa fa-link" aria-hidden=true></i></a></h2><p>This troubleshooting guide is intended to help you sort out connection issues between your laptop and MegaSquirt®. Typically these are things like <a href=http://www.efianalytics.com/TunerStudio/>TunerStudioMS</a> error messages of the sort &ldquo;<em>Controller code version does not match signature &mldr;</em>&rdquo; (which is caused by an INI file not matching the loaded code, in this case) or &ldquo;<em>ERROR: Command not recognized, e=0xE1</em>&rdquo; which usually means a serial port connection with a MegaSquirt® controller connected to it was not found.</p><p>There are certain things that have to be in place and functional for MegaSquirt® to talk properly to your laptop:</p><ul><li>A working serial port on your laptop/PC (and one which is not being used by another program like a fax/modem),</li><li>Power (12V and ground) to MegaSquirt® while trying to communicate (the 12V power supply must be between ~9 and ~17 Volts, and &lsquo;electrically clean&rsquo;, so battery chargers are not suitable),</li><li>A suitable &lsquo;straight-though&rsquo; serial cable to connect the laptop to MegaSquirt® EFI Controller, and working serial communications hardware on the MegaSquirt® board,</li><li>A functional processor,</li><li>Appropriate code loaded on the processor,</li><li>A properly installed and configured program (usually <a href=http://www.efianalytics.com/TunerStudio/>TunerStudioMS</a>) on the laptop/PC to talk to MegaSquirt® EFI Controller,</li></ul><p>We will go through each of these in turn for either <a href=http://www.megamanual.com#ms1>MegaSquirt-I</a> or <a href=http://www.megamanual.com#ms2>MegaSquirt-II</a>.</p><p><strong><em>MegaSquirt-II</em></strong>:</p><ol><li>With 2.88+ code, the first thing you must do is set the ECU Type (under &lsquo;<em>Fuel Set-Up/General</em>') to match your hardware (MS-II or MicroSquirt™), MegaTune will not let you change anything else until you do this. Do not change settings, expect the stim to work, load an MSQ, etc., until you have set the ECU Type (MS-II = 1, MicroSquirt® = 2, the MS-II Sequencer will be 3). This setting applies to MS-II derivatives with code 2.88 or higher code only.</li></ol><p>ECU Type setting was inserted to head off the potential MicroSquirt® problems due to the coils being turned on with the old default configuration. As of the 2.88 code, if ECU Type is not set, the code will put the ignition outputs in a safe state (cycling the rpm from 0 to 8000 rpm, and also flashing the fuel pump LED) and wait until a known ECU type is put in by the user.</p><ol start=2><li>Use the portCheck.exe program that comes with MegaTune to make sure you are trying to connect using the appropriate com port. portCheck.exe should be in the MegaTune directory, something like: <em>C:Program FilesMegaSquirtMegaTune2.25portCheck.exe</em> (double click on it to run it). Make sure MegaSquirt is connected and powered up, and portCheck will report the proper com port and code signature info if it is able to connect.</li><li>If you have a MegaSquirt® controller, be sure that the DB9 connectors are fully seated at both ends of the cable. if you have a MicroSquirt® EFI controller, be sure the DB9 and mini-stereo connectors are fully seated.</li><li><strong>Check the serial port on the laptop/PC</strong>. We need to verify that your laptop/PC actually has a functional serial port before proceeding.<ol><li>If <strong>you have a USB/serial adapter</strong> instead of a built in serial port:<ul><li>You may have to play with the USB adapter COM port settings in Windows for the adapter to get it to work (see Control Panel/System/Hardware/Device Manager).</li><li>Make sure that your com port settings are correct for your serial port or your USB/serial cable. For example, change the baud rate (under &lsquo;start/Control Panel/System/Hardware/Device Manager/Ports (COM & LPT)') to 115200 for MS-II.</li><li>Try re-installing your USB driver.</li><li>Check this thread on the <a href=http://www.msefi.com>www.msefi.com</a> support forums for new info: <a href="http://www.msefi.com/viewtopic.php?t=3410">USB to Serial Adapters</a>.</li></ul></li><li>First check that nothing else is using the serial port, such as a fax/modem. To find if other programs are running, first try &lsquo;Ctrl-Alt-Del&rsquo; all together (but just once). This should list all the programs that are running. Look for any that <em>might</em> be a fax/modem (you must keep systray and explorer).</li></ol></li></ol><p>You can kill any extraneous programs you find directly from the dialog that springs up when you do ctrl/alt/delete, or you can look in &lsquo;start/program&rsquo; to see if any fax/modem software is listed and configure it to not start on power-up. Alternatively, you can also type msconfig in the run box to see what is starting and block any program from loading.</p><pre><code>3. On your laptop PC, be sure to disable any other programs that might try to use the serial port, etc. This includes Infra-red communications (IrDA). For example, if you have your IrDA switched on it might go looking for a connection at regular intervals (usually in the middle of something important). 
4. Then recheck the serial communications tests in the manual (you should have already checked them during assembly, but if you bought your MegaSquirt® controller already assembled, you need to verify the serial com port on YOUR computer): _ Note: If you have MegaTune installed, you can use Mini-Terminal (under 'Communications' in MegaTune) instead of hyperterminal. Mini-term does local echo, so you should see every character you type appear on the screen twice (pop it up and hit F1). _
</code></pre><p>You may have to try different com port numbers (COM1, COM2, &mldr; COM99) to find out which com port number is assigned to the physical connection you are using for MegaSquirt. <strong><em>Be sure to note which com port you successfully used for the loopback tests, you will need to enter it later into other downloading and tuning programs.</em></strong></p><p>This &lsquo;loopback test&rsquo; verifies that you have a working serial port on your laptop/ PC computer, and that you have selected the correct one to communicate with MegaSquirt® EFI Controller, however it does not distinguish between a null modem cable and a straight-through cable.</p><pre><code>5. You may have to play with the USB adapter settings in Windows for the adapter to get it to work (see Control Panel/System/Hardware/Device Manager). If there is a 'buffer' setting, set it as low as you can (often 1 or 0). 
6. Make sure that your com port settings are correct for your serial port or your USB/serial cable. For example, change the baud rate (under 'start/Control Panel/System/Hardware/Device Manager/Ports (COM &amp; LPT)') to 9600 for MS-I. 
7. Try re-installing your USB driver. 
8. Search the forums at [www.msefi.com ][42]for new info on: &quot;USB to Serial Adapters&quot;. 
9. If you have another computer available (a laptop or another desktop, for example), you might want to try that to connect to your MegaSquirt® controller - this can help rule out a damaged or mis-configured serial port on the computer. 
</code></pre><ol start=5><li><strong>Check the power supply</strong>. MegaSquirt® must be powered in order to communicate. Check the DC Volts at the stim&rsquo;s terminal block <strong><em>while powering MegaSquirt</em></strong>. It should be at least 7.5 Volts, preferably 8.5V or above.</li></ol><blockquote><p>A 9 Volt battery will drain very quickly. You might measure close to that at the battery. But if that&rsquo;s &lsquo;open circuit&rsquo; voltage (i.e. measured across the unconnected terminals of the battery), the voltage is likely much lower when powering MegaSquirt (9V batteries are only designed to produce about 1/3 the current MegaSquirt® controller normally draws).</p><p>A noisy (or failing) power supply will also do what you see, as it causes the MegaSquirt to continually reset, starting to communicate but failing again and again.</p><p>You can use a cheap wall-wart style AC/DC adapter (you might salvage these from dead electronic devices whenever you can). You&rsquo;ll want a 200 to 300 milliamp, 9 to 12 Volt DC (VDC) adaptor. Because these adaptors are usually unregulated, the lower the current draw below their rating, the higher the voltage will be. MegaSquirt and the stim usually draw around 150 to 250 milliamps, this needs to be at least 9 Volts and shouldn&rsquo;t be much over 17 Volts.</p><p>The best way to be sure is to use a voltmeter on the two wires from wall wart without it attached to anything (just plugged in). Then the current draw is essentially zero, and the voltage is at its maximum. If it is below 17 Volts, its not too much. If it passes that test, then hook the wall wart adapter to MegaSquirt/stim and check the voltage again - if it&rsquo;s over 9 Volts or so you are have found a suitable power supply!</p></blockquote><p>Then check the power at the 40-pin socket as described in the assembly guide for your main board.</p><p>To test, install a battery in the stimulator, and plug it into the DB-37 connector on the ECU board. Next, using a DMM (digital multi-meter) on DC VOLTS setting, check for 5 volts on the 40-pin processor socket you installed in step #3 (which is empty) - there should be 5 volts between pins 19 (ground) and 20 (+5), there should also be +5 on pin 1 and 31 (check against ground at pin 19), and ground potential on pins 2 and 32 (check against +5V on pin 20).</p><p>An easy way to probe this is by using a component lead that you cut from one of the resistors and wrapping around the DMM probe tip, then plugging into the socket. Remember that with the PCB oriented so the copyright notice is at the bottom (and can be read &lsquo;right-side up&rsquo;), pin #1 on the 40-pin socket is on the lower right (at the same end with the notch), then goes up the 20 pins on that side, then over to the other side top, then down - it traces a counter-clockwise circle.</p><p>Check each box below as you measure the voltage between the ground pins across the top and the +5 pins down the left. You should get a voltage between 4.9 to 5.1 volts in each case (if your multi meter is accurate). Unplug the stimulator when finished.</p><p>| &mdash;&ndash; |
| Pin | grounds |<br>| | 2 | 19 | 32 |
| 1<br>(5 Volt) | ____ | ____ | ____ |
| 20<br>(5 Volt) | ____ | ____ | ____ |
| 31<br>(5 Volt) | ____ | ____ | ____ |</p><p><em>(Reinsert MS-II after testing, be sure to get it the correct way around - the 6-pin header should be nearest the edge of the PCB.)</em>
6. <strong>Check the serial cable and serial circuit</strong>. You need to ensure that you cable is straight-through and not a null modem cable, as well as that it doesn&rsquo;t have other functional problems. To do this:</p><p>This second &lsquo;loopback test&rsquo; verifies that you have a working serial port on your laptop/PC computer, and it does distinguish between a null modem cable and a straight-through cable. It also verifies that the serial com circuit on MegaSquirt® itself is working. However it does not necessarily verify that the com port speed setting (baud rate) is correct.</p><p>If you do not pass this test, you may have a faulty solder joint in the com circuits, you need to inspect every solder joint very carefully, and touch up any that don&rsquo;t look perfect. If everything is good on the solder joints, you have not missed installing any components, and nothing is shorted or bridged, then one or more of the serial circuit components is likely damaged (such as the MAX232).</p><p>Check on the MAX232 (U6) that you have:</p><pre><code>* 5 Volts on pin #16, 
* ground on pin #15 (less than 1 Ohm from pin 15 of the MAX232 to the center pin of the voltage regulator). 
</code></pre><p>Then check the continuity between:</p><pre><code>* pin 12 of the MAX232 to CPU pin 13 (RxD-1) 
* pin 11 of the MAX232 to CPU pin 12 (TxD-1) 
</code></pre><p>Both of these should be under 1 Ohm. Check that you have 5.0 Volts on pin 16 of the MAX232 when the MegaSquirt® main board is powered up. Also check that you get less than 1 Ohm from pin 15 of the MAX232 to the center pin of the voltage regulator.</p><p>Check the continuity from the MAX232 to the DB9 pins:</p><pre><code>1. DB9 pin #1: connects to MAX232 pin #16, 
2. DB9 pin #2: connects to MAX232 pin #14, 
3. DB9 pin #3: connects to MAX232 pin #13, 
4. DB9 pin #4: connects to DB9 pin #6 
5. DB9 pin #5: connects to MAX232 pin #15, 
6. DB9 pin #6: connects to DB9 pin #4 
7. DB9 pin #7: connects to MAX232 pin #8, 
8. DB9 pin #8: connects to MAX232 pin #7, 
9. DB9 pin #9: connects to VCC (5.0 Volts at the voltage regulator pin furthest from the DB9), 
</code></pre><p>Each of the above connections should have 1.0 Ohms or less between the specified points when the MegaSquirt® is not powered. If you get higher resistance than this, you may need to touch up solder joints, or inspect the board for burnt traces. (Note that the DB pin numbers are imprinted into the plastic - though they may be hard to see.)</p><p>If those are all good, then suspect the MAX232 itself.</p><p><img src=http://www.megamanual.com/ms2/v3pcb_8.gif alt></p><ol start=7><li><strong>Check for a functional processor</strong>. If the processor has power on the 40-pin socket, but none of the LEDs on the MegaSquirt® or stim respond, then the processor might not be working. This can be because the processor is damaged, or because the crystal is not working. Crystals are fairly fragile, though we have not had failures with the MS-II crystal.</li></ol><p>If you have successfully passed all the loopback test, the crystal is working, and there is power and ground to the appropriate pins on the 40-pin socket, then the processor itself may be damaged.</p><p>If you suspect the processor itself, the first thing to try is to reload the code (<em>see the next step</em>) since this is free and will often solve a processor problem. Of course you need a working serial port to do this, so you may have to try all the other steps first.</p><ol start=8><li><strong>Check that you have appropriate code loaded on the processor</strong>. For MegaSquirt-II, the daughtercard comes essentially blank, and you have to load code before the processor will communicate with the laptop/PC.<ol><li>Download the code from the Internet. Get the latest version of MegaSquirt-II code here:</li><li>Power down MegaSquirt® EFI Controller,</li><li>Put the boot jumper on both pins of the header marker B/LD (for &ldquo;bootloader&rdquo;) on the MegaSquirt-II (not the main board),</li></ol></li></ol><p><img src=http://www.megamanual.com/ms2/bootjmpr.gif alt></p><pre><code>4. Power up MegaSquirt® (plug in the stim). The LEDs on MegaSquirt® will flash very briefly (if installed), then go out. This is proper response for the LEDs when the MegaSquirt-II goes into bootloader mode (i.e. when the bootloader jumper is on). 
5. Start the downloader program (make sure TunerStudioMS or MegaTune are not running), and select the appropriate COM port (from the loopback tests) and speed (115200 for MegaSquirt-II), 
6. Select the appropriate .S19 file (_that you downloaded above_), and the downloader will read, write and verify the code to the processor in about 10 seconds or so. 
7. The process ends with a message like &quot;Verification succeeded, 999 records total (4 skipped).&quot; 
8. Shut down the downloader program. 
9. Remove power from MegaSquirt® (disconnect the stim). 
10. Remove the boot jumper (or put it on just one pin of the B/LD header for storage). When you power MegaSquirt® back up again, it should come to life running the newly loaded code. 
</code></pre><ol start=9><li><strong>Install and configure a program(s) on the laptop/PC to talk to MegaSquirt</strong>®, this is usually <a href=http://www.efianalytics.com/TunerStudio/>TunerStudio</a> or <a href=http://www.megamanual.com/files/software/>MegaTune</a>.</li></ol><p>For TunerStudioMS details, see <a href=http://www.efianalytics.com/TunerStudio/>the TunerStudio website</a>.</p><p>MegaTune is not recommended for any newer firmwares, it hasn&rsquo;t been updated in years, and is missing some necessary functionality (as well as many convenient features).</p><ol start=10><li><strong>Open <a href=http://www.efianalytics.com/TunerStudio/>TunerStudoMS</a> and set the com port</strong> (from your loopback tests) and the baud rate (115200 for MegaSquirt-II) under &lsquo;<em>Communications/Settings</em>&rsquo;.</li></ol><p><em>Click the links to find more information on <a href=http://www.megamanual.com/ms2/configure.htm>Configuring MS-II</a></em>.</p><ol start=11><li><strong>If you have changed code version (or loaded code for the first time), you may need to change the INI file</strong> to match the new code. The files have names like &ldquo;megasquirt-II_2905.ini&rdquo;, where 2905 indicates the 2.905 code it is to be used with.</li></ol><p>(New code versions (2.889+) have their own INI, so for example 2.890 code (<a href=http://www.megamanual.com/files/code/Monitor_v2.890.abs.s19>Monitor_v2.890.abs.s19</a>) has a specific 2.980 INI (<a href=http://www.megamanual.com/files/ini/megasquirt-II.ini.2.890>megasquirt-II.ini.2.890</a>).</p><p>You will find the INI files here: and the code S19 loadable files here:</p><p>Note that all older 2.XY (prior to 2.889) use the same 2.X INI file. For example, the 2.35 code uses the 2.3 INI file. This is the way the older code upgrades are designed. Major revisions were incremented by +0.1 and require a new INI file, minor revisions (+0.01) use the same INI file.)</p><p><em>You may also need to install a fresh INI file if you have edited it manually, and made any mistakes (which is easy to do and often shows up as a comms error - typically the controller will connect with the tuning software, but then it will go offline after a second or two, and not re-connect unless the power is cycled - starting the process again).</em></p><p>You can select new INI to match code you have loaded by:</p><pre><code>1. going to 'File→Project→Project Properties' in [TunerStudioMS][38], 
2. checking the 'Other' box, 
3. clicking on 'Browse', 
4. surfing to the INI, and 
5. double clicking on the correct INI. 
</code></pre><p><strong><em>MegaSquirt-I</em></strong>:</p><ol><li><strong>Check the serial port on the laptop/PC</strong>. We need to verify that your laptop/PC actually has a functional serial port before proceeding.<ol><li>First check that nothing else is using the serial port, such as a fax/modem. To find if other programs are running, first try &lsquo;Ctrl-Alt-Del&rsquo; all together (but just once). This should list all the programs that are running. Look for any that <em>might</em> be a fax/modem (you must keep systray and explorer).</li></ol></li></ol><p>You can kill any extraneous programs you find directly from the dialog that springs up when you do ctrl/alt/delete, or you can look in &lsquo;start/program&rsquo; to see if any fax/modem software is listed and configure it to not start on power-up. Alternatively, you can also type msconfig in the run box to see what is starting and block any program from loading.</p><pre><code>2. Use the portCheck.exe program that comes with MegaTune to make sure you are trying to connect using the appropriate com port. portCheck.exe should be in the MegaTune directory, something like: _C:Program FilesMegaSquirtMegaTune2.25portCheck.exe_ (double click on it to run it). Make sure MegaSquirt is connected and powered up, and portCheck will report the proper com port and code signature info if it is able to connect. 
3. On your laptop PC, be sure to disable any other programs that might try to use the serial port, etc. This includes Infra-red communications (IrDA). For example, if you have your IrDA switched on it might go looking for a connection at regular intervals (usually in the middle of something important). 
4. Then recheck the serial communications tests in the manual (you should have already checked them during assembly, but if you bought your MegaSquirt® assembled, you need to verify the serial com port on YOUR computer): _ Note: If you have MegaTune installed, you can use Mini-Terminal (under 'Communications' in MegaTune) instead of hyperterminal. Mini-term does local echo, so you should see every character you type appear on the screen twice (pop it up and hit F1). _
</code></pre><p>You may have to try different com port numbers (COM1, COM2, &mldr; COM99) to find out which com port number is assigned to the physical connection you are using for MegaSquirt. <strong><em>Be sure to note which com port you successfully used for the loopback tests, you will need to enter it later into other downloading and tuning programs.</em></strong></p><p>This &lsquo;loopback test&rsquo; verifies that you have a working serial port on your laptop/ PC computer, and that you have selected the correct one to communicate with MegaSquirt® EFI Controller, however it does not distinguish between a null modem cable and a straight-through cable.</p><pre><code>5. You may have to play with the USB adapter settings in Windows for the adapter to get it to work (see Control Panel/System/Hardware/Device Manager). If there is a 'buffer' setting, set it as low as you can (often 1 or 0). 
6. Make sure that your com port settings are correct for your serial port or your USB/serial cable. For example, change the baud rate (under 'start/Control Panel/System/Hardware/Device Manager/Ports (COM &amp; LPT)') to 9600 for MS-I. 
7. Try re-installing your USB driver. 
8. Check this thread on the www.msefi.com support forums for new info: [USB to Serial Adapters][41]. 
9. Finally, if you have another computer available (a laptop or another desktop, for example), you might want to try that to connect to your MegaSquirt® controller - this can help rule out a damaged or mis-configured serial port on the computer. 
</code></pre><ol start=2><li><strong>Check the power supply</strong>. MegaSquirt® must be powered in order to communicate. Check the DC Volts at the stim&rsquo;s terminal block <strong><em>while powering MegaSquirt</em></strong>. It should be at least 7.5 Volts, preferably 8.5V or above.</li></ol><blockquote><p>A 9 Volt battery will drain very quickly. You might measure close to that at the battery. But if that&rsquo;s &lsquo;open circuit&rsquo; voltage (i.e. measured across the unconnected terminals of the battery), the voltage is likely much lower when powering MegaSquirt (9V batteries are only designed to produce about 1/3 the current MegaSquirt® controller normally draws).</p><p>A noisy (or failing) power supply will also do what you see, as it causes the MegaSquirt to continually reset, starting to communicate but failing again and again.</p><p>You can use a cheap wall-wart style AC/DC adapter (you might salvage these from dead electronic devices whenever you can). You&rsquo;ll want a 200 to 300 milliamp, 9 to 12 Volt DC (VDC) adaptor. Because these adaptors are usually unregulated, the lower the current draw below their rating, the higher the voltage will be. MegaSquirt and the stim usually draw around 150 to 250 milliamps, this needs to be at least 9 Volts and shouldn&rsquo;t be much over 17 Volts.</p><p>The best way to be sure is to use a voltmeter on the two wires from wall wart without it attached to anything (just plugged in). Then the current draw is essentially zero, and the voltage is at its maximum. If it is below 17 Volts, its not too much. If it passes that test, then hook the wall wart adapter to MegaSquirt/stim and check the voltage again - if it&rsquo;s over 9 Volts or so you are have found a suitable power supply!</p></blockquote><p>Then check the power at the 40-pin socket as described in the assembly guide for your main board. To test, install a battery in the stimulator, and plug it into the DB-37 connector on the ECU board. Next, using a DMM (digital multi-meter) on DC VOLTS setting, check for 5 volts on the 40-pin processor socket you installed in step #3 (which is empty) - there should be 5 volts between pins 19 (ground) and 20 (+5), there should also be +5 on pin 1 and 31 (check against ground at pin 19), and ground potential on pins 2 and 32 (check against +5V on pin 20).</p><p>An easy way to probe this is by using a component lead that you cut from one of the resistors and wrapping around the DMM probe tip, then plugging into the socket. Remember that with the PCB oriented so the copyright notice is at the bottom (and can be read &lsquo;right-side up&rsquo;), pin #1 on the 40-pin socket is on the lower right (at the same end with the notch), then goes up the 20 pins on that side, then over to the other side top, then down - it traces a counter-clockwise circle.</p><p>Check each box below as you measure the voltage between the ground pins across the top and the +5 pins down the left. You should get a voltage between 4.9 to 5.1 volts in each case (if your multi meter is accurate). Unplug the stimulator when finished.</p><p>| &mdash;&ndash; |
| Pin | grounds |<br>| | 2 | 19 | 32 |
| 1<br>(5 Volt) | ____ | ____ | ____ |
| 20<br>(5 Volt) | ____ | ____ | ____ |
| 31<br>(5 Volt) | ____ | ____ | ____ |</p><p><em>(Be sure to insert the processor the correct way around after testing, the notch should go at the end of the 40-pin socket closest to the edge of the PCB.)</em>
3. <strong>Check the serial cable and serial circuit</strong>. You need to ensure that you cable is straight-through and not a null modem cable, as well as that it doesn&rsquo;t have other functional problems. To do this:</p><p>This second &lsquo;loopback test&rsquo; verifies that you have a working serial port on your laptop/PC computer, and it does distinguish between a null modem cable and a straight-through cable. It also verifies that the serial com circuit on MegaSquirt® itself is working. However it does not necessarily verify that the com port speed setting (baud rate) is correct.</p><p>If you do not pass this test, you may have a faulty solder joint in the com circuits, you need to inspect every solder joint very carefully, and touch up any that don&rsquo;t look perfect. If everything is good on the solder joints, you have not missed installing any components, and nothing is shorted or bridged, then one or more of the serial circuit components is likely damaged (such as the MAX232).</p><p>Check on the MAX232 (U6) that you have:</p><pre><code>* 5 Volts on pin #16, 
* ground on pin #15 (less than 1 Ohm from pin 15 of the MAX232 to the center pin of the voltage regulator). 
</code></pre><p>Then check the continuity between:</p><pre><code>* pin 12 of the MAX232 to CPU pin 13 (RxD-1) 
* pin 11 of the MAX232 to CPU pin 12 (TxD-1) 
</code></pre><p>Both of these should be under 1 Ohm. Check that you have 5.0 Volts on pin 16 of the MAX232 when the MegaSquirt® main board is powered up. Also check that you get less than 1 Ohm from pin 15 of the MAX232 to the center pin of the voltage regulator.</p><p>Check the continuity from the MAX232 to the DB9 pins:</p><pre><code>1. DB9 pin #1: connects to MAX232 pin #16, 
2. DB9 pin #2: connects to MAX232 pin #14, 
3. DB9 pin #3: connects to MAX232 pin #13, 
4. DB9 pin #4: connects to DB9 pin #6 
5. DB9 pin #5: connects to MAX232 pin #15, 
6. DB9 pin #6: connects to DB9 pin #4 
7. DB9 pin #7: connects to MAX232 pin #8, 
8. DB9 pin #8: connects to MAX232 pin #7, 
9. DB9 pin #9: connects to VCC (5.0 Volts at the voltage regulator pin furthest from the DB9), 
</code></pre><p>Each of the above connections should have 1.0 Ohms or less between the specified points when the MegaSquirt® is not powered. If you get higher resistance than this, you may need to touch up solder joints, or inspect the board for burnt traces. (Note that the DB pin numbers are imprinted into the plastic - though they may be hard to see.)</p><p>If those are all good, then suspect the MAX232 itself.</p><p><img src=http://www.megamanual.com/ms2/v3pcb_8.gif alt></p><ol start=4><li><strong>Check for a functional processor</strong>. If the processor has power on the 40-pin socket, but none of the LEDs on the MegaSquirt® or stim respond, then the processor might not be working. This can be because the processor is damaged, or because the crystal is not working.</li></ol><p>Crystals are fairly fragile, and we occasionally see failures with the MS-II crystal. There&rsquo;s no real voltage test for the crystal, but if your multimeter measures frequency you can look for 32.76 kHz on pin #4 of the CPU (with the non-banded end of D1 as a ground on a V2.2 board, or the heat sink as ground on a V3 board). The crystal is much cheaper and more commonly available than the processor, so you might want to replace it first before deciding the processor is damaged.</p><p>If you have successfully passed all the loopback test, the crystal is working, and there is power and ground to the appropriate pins on the 40-pin socket, then the processor itself may be damaged.</p><p>If you suspect the processor itself, the first thing to try is to reload the code (<em>see the next step</em>). Of course you need a working serial port to do this, so you may have to try all the other steps first.</p><ol start=5><li><strong>Check that you have appropriate code loaded on the processor</strong>. For MegaSquirt-I, the comes with code already loaded, and you should not have to load code before the processor will communicate with the laptop/PC. However, it&rsquo;s not impossible that the code was wiped or was never loaded by accident. To load the code:<ol><li>Download the code from the Internet. Get the latest version of MegaSquirt-I code here: <em>The MegaSquirt-I/II downloader comes with the standard B&G 3.00 code as part of the installer, should be in c:/Program Files/MegaSquirt/Firmware/MS-I/megasquirt_v3000.s19 along with some other files.</em></li><li>Power down MegaSquirt® EFI Controller,</li><li>Put a boot jumper (a short piece of bare wire or lead cut from a resistor or capacitor, etc.) to connect both holes in the area marked Boot (for &ldquo;bootloader&rdquo;) on the main board,</li><li>Power up MegaSquirt® (plug in the stim).</li><li>Start the downloader program, and select the appropriate COM port (from the loopback tests) and speed (9600 for MegaSquirt-I),</li><li>Select the appropriate .S19 file (<em>that you downloaded above</em>), and the downloader will read, write and verify the code to the processor in about 10 seconds or so.</li><li>The process ends with a message like &ldquo;Verification succeeded, 999 records total (4 skipped).&rdquo;</li><li>Shut down the downloader program.</li><li>Remove power from MegaSquirt® (disconnect the stim).</li><li>Remove the boot jumper. When you power MegaSquirt® back up again, it should come to life running the newly loaded code.</li></ol></li><li><strong>Install and configure a program(s) on the laptop/PC to talk to MegaSquirt</strong>, this is usually <a href=http://www.efianalytics.com/TunerStudio/>TunerStudio instead</a>, or <a href=http://www.megamanual.com/files/software/>MegaTune</a>.</li></ol><p>For TunerStudioMS details, see <a href=http://www.efianalytics.com/TunerStudio/>the TunerStudio website</a>.</p><p>MegaTune is not recommended for any newer firmwares, it hasn&rsquo;t been updated in years, and is missing some necessary functionality (as well as many convenient features).</p><p>If these steps don&rsquo;t solve your communications problems, please send a message to us on our forums at <a href=http://www.msefi.com>www.msefi.com</a>. Include any diagnostic info you have gathered from performing the above procedures and tests.</p><hr><hr><p>MegaSquirt® and MicroSquirt® controllers are experimental devices intended for educational purposes.<br>MegaSquirt® and MicroSquirt® controllers are not for sale or use on <a href=http://www.megamanual.com/tamp.htm>pollution controlled vehicles</a>. Check the laws that apply in your locality to determine if using a MegaSquirt® or MicroSquirt® controller is legal for your application.</p><hr><p>©2006, 2010 Bruce Bowling and Al Grippo. All rights reserved. MegaSquirt® and MicroSquirt® are registered trademarks. This document is solely for the support of MegaSquirt® boards from Bowling and Grippo.</p></article></section></div><footer class=footer><section class=container><p>2021</p></section></footer></main><script src=/js/coder.min.235666b114443867d43eeb5799d51f6252965e5163f338285e113fa381d3d27e.js integrity="sha256-I1ZmsRREOGfUPutXmdUfYlKWXlFj8zgoXhE/o4HT0n4="></script><script>(function(e,b,f,c,a,d){b[c]=b[c]||function(){(b[c].q=b[c].q||[]).push(arguments)},a=e.createElement('script'),d=e.getElementsByTagName('script')[0],a.async=1,a.src=f,a.id='fathom-script',d.parentNode.insertBefore(a,d)})(document,window,'//analytics.example.com/tracker.js','fathom'),fathom('set','siteId','ABCDE'),fathom('trackPageview')</script><script async defer data-domain=example.com src=https://analytics.example.com/js/plausible.js></script><script data-goatcounter=https://ovenell-guru.goatcounter.com/count async src=//gc.zgo.at/count.js></script></body></html>